const userModel = require('../models/user.model');
const orderModel = require('../models/order.models');
const productModel = require('../models/product.model');
const {subscribeToQueue} = require('./broker');
const paymentModel = require('../models/payment.models');


module.exports = function(){
    subscribeToQueue('AUTH_SELLER_DASHBOARD.USER_CREATED',async(user)=>{
        await userModel.create(user);
    });

    subscribeToQueue('PRODUCT_SELLER_DASHBOARD.PRODUCT_CREATED',async(product)=>{
        await productModel.create(product);
    });
    subscribeToQueue('ORDER_SELLER_DASHBOARD.ORDER_CREATED',async(orders)=>{
        await orderModel.create(orders);
    });
    subscribeToQueue('PAYMENT_SELLER_DASHBOARD.PAYMENT.CREATED',async(payment)=>{
        await paymentModel.create(payment);
    });
    subscribeToQueue('PAYMENT_SELLER_DASHBOARD.PAYMENT.UPDATED',async(payment)=>{
        await paymentModel.findOneAndUpdate({order:payment.order},{...payment});
    });
}